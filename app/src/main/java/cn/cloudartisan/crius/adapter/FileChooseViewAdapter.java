/**
  * Generated by smali2java 1.0.0.558
  * Copyright (C) 2013 Hensence.com
  */

package cn.cloudartisan.crius.adapter;

import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import cn.cloudartisan.crius.R;
import cn.cloudartisan.crius.util.FileTypeIconBuilder;
import cn.cloudartisan.crius.util.FileUtil;

import java.io.File;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;

public class FileChooseViewAdapter extends BaseAdapter {
    protected Context context;
    protected List<File> list=new ArrayList<>();
    
    public FileChooseViewAdapter(Context c, List<File> list) {
        context = c;
       this.list = list;
    }
    
    public int getCount() {
        return list.size();
    }
    
    public File getItem(int position) {
        return list.get(position);
    }
    
    public void notifyDataSetChanged() {
        Collections.sort(list, new FileChooseViewAdapter.FileAscComparator());
        super.notifyDataSetChanged();
    }
    
    public long getItemId(int position) {
        return 0x0;
    }
    
    public View getView(int position, View convertView, ViewGroup parent) {
        File file = getItem(position);
        if(convertView == null) {
            convertView = LayoutInflater.from(context).inflate(R.layout.item_filechoose, null);
        }
        ( (TextView)convertView.findViewById(R.id.fileName)).setText(file.getName());
        if(file.isDirectory()) {
            convertView.findViewById(R.id.arrow).setVisibility(View.VISIBLE);
            convertView.findViewById(R.id.fileSize).setVisibility(View.GONE);
            ((ImageView)convertView.findViewById(R.id.fileIcon)).setImageResource(R.drawable.format_folder);
            return convertView;
        }
        convertView.findViewById(R.id.fileSize).setVisibility(View.VISIBLE);
        ( (TextView)convertView.findViewById(R.id.fileSize)).setText(FileUtil.getSizeName(file.length()));
        convertView.findViewById(R.id.arrow).setVisibility(View.GONE);
        ((ImageView)convertView.findViewById(R.id.fileIcon)).setImageResource(FileTypeIconBuilder.create(context).getFileIcon(file.getName(), false));
        return convertView;
    }

    public static class FileAscComparator
            implements Comparator<File>
    {
        public int compare(File paramFile1, File paramFile2)
        {
            if (((paramFile1.isDirectory()) && (paramFile2.isDirectory())) || ((paramFile1.isFile()) && (paramFile2.isFile()))) {
                return paramFile1.getName().compareToIgnoreCase(paramFile2.getName());
            }
            if ((paramFile1.isDirectory()) && (paramFile2.isFile())) {
                return -1;
            }
            if ((paramFile1.isFile()) && (paramFile2.isDirectory())) {
                return 1;
            }
            return paramFile1.compareTo(paramFile2);
        }
    }
}
