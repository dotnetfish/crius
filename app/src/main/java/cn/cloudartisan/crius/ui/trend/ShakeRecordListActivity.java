/**
  * Generated by smali2java 1.0.0.558
  * Copyright (C) 2013 Hensence.com
  */

package cn.cloudartisan.crius.ui.trend;

import android.content.Context;
import android.content.Intent;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ListView;
import cn.cloudartisan.crius.R;
import cn.cloudartisan.crius.adapter.ShakeRecordListViewAdapter;
import cn.cloudartisan.crius.app.Global;
import cn.cloudartisan.crius.bean.ShakeRecord;
import cn.cloudartisan.crius.bean.User;
import cn.cloudartisan.crius.db.ShakeRecordDBManager;
import cn.cloudartisan.crius.ui.base.BaseActivity;
import cn.cloudartisan.crius.ui.contact.UserDetailActivity;
import cn.cloudartisan.crius.widget.CustomDialog;

public class ShakeRecordListActivity extends BaseActivity implements CustomDialog.OnOperationListener, AdapterView.OnItemLongClickListener, AdapterView.OnItemClickListener {
    protected ShakeRecordListViewAdapter adapter;
    Context context;
    CustomDialog customDialog;
    ListView memberListView;
    User self;
    
    public void initComponents() {
        setDisplayHomeAsUpEnabled(true);
        memberListView = (ListView)findViewById(R.id.memberListView);
        adapter = new ShakeRecordListViewAdapter(this, ShakeRecordDBManager.getManager().queryRecordList());
        memberListView.setAdapter(adapter);
        memberListView.setOnItemClickListener(this);
        memberListView.setOnItemLongClickListener(this);
        customDialog = new CustomDialog(this);
        customDialog.setOperationListener(this);
        customDialog.setTitle(R.string.common_hint);
        customDialog.setMessage(getString(R.string.tip_delete_record));
        customDialog.setButtonsText(getString(R.string.common_cancel), getString(R.string.common_confirm));
        self = Global.getCurrentUser();
    }
    
    public void onClick(View v) {
        v.getId();
    }
    
    public void onItemClick(AdapterView<?> arg0, View arg1, int index, long arg3) {
        ShakeRecord target = adapter.getItem(index);
        Intent intent = new Intent(this, UserDetailActivity.class);
        intent.putExtra("user", target.toFriend());
        startActivity(intent);
    }
    
    public boolean onItemLongClick(AdapterView<?> arg0, View arg1, int index, long arg3) {
        customDialog.setTag(adapter.getItem(index));
        customDialog.show();
        return true;
    }
    
    public void onLeftClick() {
        customDialog.dismiss();
    }
    
    public void onRightClick() {
        ShakeRecord target = (ShakeRecord)customDialog.getTag();
        adapter.remove(target);
        ShakeRecordDBManager.getManager().deleteShakeRecord(target.account);
        customDialog.dismiss();
    }
    
    public int getConentLayout() {
        return R.layout.activity_group_member_list;
    }
    
    public int getActionBarTitle() {
        return R.string.label_shake_record;
    }
}
