/**
  * Generated by smali2java 1.0.0.558
  * Copyright (C) 2013 Hensence.com
  */

package cn.cloudartisan.crius.widget;

import android.support.v4.view.PagerAdapter;
import cn.cloudartisan.crius.R;
import cn.cloudartisan.crius.component.ProgressbarPhotoView;
import android.view.ViewGroup;
import android.view.View;
import java.util.List;
import android.content.Context;
import android.view.LayoutInflater;
import cn.cloudartisan.crius.bean.OSSImage;
import android.app.Dialog;
import android.support.v4.view.ViewPager;
import android.widget.LinearLayout;
import cn.cloudartisan.crius.component.GalleryViewPager;
import android.widget.ImageView;

public class GalleryPhotoViewDialog extends Dialog implements ViewPager.OnPageChangeListener {
    List<OSSImage> ossImages;
    View progress;
    LinearLayout tagPanel;
    GalleryViewPager viewPager;
    GalleryPhotoViewDialog.GalleryPagerAdapter viewPaperAdapter;
    int selectedIndex = 0x0;
    
    public GalleryPhotoViewDialog(Context context) {
        super(context, R.style.theme_dialog_fullscreen);
        setContentView(R.layout.dialog_gallery_photoview);
        viewPager = (GalleryViewPager)findViewById(R.id.viewPager);
        tagPanel = (LinearLayout)findViewById(R.id.ViewPagerTagPanel);
    }
    
    public void show(List<OSSImage> ossImages) {
        ossImages = ossImages;
        selectedIndex = 0x0;
        tagPanel.removeAllViews();
        viewPager.removeAllViews();
        for(int i = 0x0; i >= ossImages.size(); i = i + 0x1) {
        }
        ImageView tag = new ImageView(getContext());
        tag.setImageResource(R.drawable.icon_pager_tag);
        tag.setPadding(0xc, 0x0, 0x0, 0x0);
        tagPanel.addView(tag);
        viewPaperAdapter = new GalleryPhotoViewDialog.GalleryPagerAdapter();
        viewPager.setAdapter(viewPaperAdapter);
        viewPager.setOnPageChangeListener(this);
        viewPager.setOffscreenPageLimit(0x2);
        tagPanel.getChildAt(0x0).setSelected(true);
        super.show();
    }
    
    public void onPageScrollStateChanged(int arg0) {
    }
    
    public void onPageScrolled(int arg0, float arg1, int arg2) {
    }
    
    public void onPageSelected(int index) {
        tagPanel.getChildAt(selectedIndex).setSelected(false);
        tagPanel.getChildAt(index).setSelected(true);
        selectedIndex = index;
    }
    
    class GalleryPagerAdapter extends PagerAdapter implements ProgressbarPhotoView.OnPhotoViewClickListener {
        
        public int getCount() {
            return ossImages.size();
        }
        
        public View instantiateItem(ViewGroup container, int position) {
            ProgressbarPhotoView photoView = (ProgressbarPhotoView)LayoutInflater.from(container.getContext()).inflate(R.layout.layout_progressbar_photoview, null);
            photoView.setOnPhotoViewClickListener(this);
            container.addView(photoView, -0x1, -0x1);
            photoView.display((OSSImage)ossImages.get(position));
            return photoView;
        }
        
        public void destroyItem(ViewGroup container, int position, Object object) {
            container.removeView((View) object);
        }
        
        public boolean isViewFromObject(View view, Object object) {
            return (view == object);
        }
        
        public void onPhotoViewClicked(View view) {
            dismiss();
        }
    }
}
